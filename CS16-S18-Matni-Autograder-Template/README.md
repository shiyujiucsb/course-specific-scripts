# Introduction

## Important Files
* ``repo/diffs.sh``: this script contains all the commands of the test cases. A test case is often like:
```
# @test{"stdout":10}
./hello < sample.stdin
```
Here the test case runs the program ``hello`` with STDIN ``sample.stdin``. The grader will check STDOUT of this program with the ground truth. This test case is worth 10 points.

* ``repo/Makefile``: this makefile builds the submissions. Please make sure it is compatible with the other scripts, e.g., ``grade.sh``, ``MAKE-REFERENCE.sh``, etc.

* ``repo/grade.sh``: this script uses the Makefile to build the submissions, and calls the diff-based-testing script to run ``diffs.sh``, and compares the generated outputs with the ground truth generated by ``MAKE-REFERENCE.sh``.

* ``repo/MAKE-REFERENCE.sh``: this script builds the code in the directory ``REFERENCE-SOLUTION``, and calls the diff-based-testing script to run ``diffs.sh`` to generate the ground-truth outputs.

* ``repo/gs-diff-based-testing/grade-diffs.py``: this script is based on [Phil Conrad and Caitlin Scarberry's work](https://github.com/ucsb-gradescope-tools/gs-diff-based-testing). It can generate ground truth outputs as well as outputs of student submissions. It can also compare the students' outputs with the ground truth. The commands to run and compare are in the file ``diffs.sh``. Currently the ground-truth outputs are generated in the setup phase (see ``setup.sh``). 

* ``repo/REFERENCE-SOLUTION``: please put the ground-truth source code files in this directory. The example file in this repo is ``hello.cpp``.

* ``repo/EXECUTION-FILES``: please put the STDIN input files in this directory.

## Usage
To prepare the zip file to upload to Gradescope, go to the directory which contains the files ``setup.sh`` and ``run_autograder``, and compress the two files and the directory ``repo``:
```
zip -r autograder_to_upload.zip *
```

## Discussions
* One may consider using a private git repo to store the test cases and ground-truth source code. 
- The advantage of this way is that one may update the test cases by contributing to the private git repo, without updating and re-building the Docker image again. 
- The downside of this way is about security: the secret keys to the private git repo have to be deployed in the repo, and the students can easily get the private information (e.g., repo URL, keys) of the repo, since they are granted root privilege.

